---
title: 'From Education to Entrepreneurship'
author: "Sam Dundon and Thierry Racaud"
date: "December 6, 2014"
output: html_document
---

<br>

### Key Question 
To what extent do teaching methods supporting self-confidence affect the rate of entrepreneurship in OECD countries?  


We have drawn on publicly availabile data from the [Global Entrepreneurship Monitor (GEM)](http://www.gemconsortium.org) National Expert Survey (NES) and Adult Population Survey (APS) to create graphic visualizations of participants' responses to surveys about entrepreneurship in [OECD (Organisation for Economic Co-operation and Development)](http://www.oecd.org/) countries.   


The following interactive chart can be utilized to see the relationship between the variables we investigated (this can be best viewed in a browser such as [Chrome](https://www.google.com/chrome/)). Among other features, the independent and dependent variables can be selected to see the relationship between each of the variables.  The variables are defined in detail below.  

```{r echo =FALSE, cache=FALSE, include=TRUE, results='asis', warning=FALSE, error=FALSE, message=FALSE}
library(ggvis)
library(devtools)
library(googleVis)
library(countrycode)
library(repmis)
library(reshape2)
library(RJSONIO)
library(shiny)
library(httpuv)

# Import "CompleteData" df from repository
CD <- repmis::source_data("https://raw.githubusercontent.com/SamDund/Assign2Education/master/GEMData/CompleteData.csv", header = TRUE, na.strings = "NA")

# Set Year column as a date
CD$Year <- as.Date(as.character(CD$Year), format = "%Y")

# Dropp X column
CD$X <- NULL

R <- gvisMotionChart(CD, idvar = "Country", timevar = "Year")

print(R, tag = 'chart')
```


<br>

### Variables:  

1. **Entrepreneurial Intention**: Percentage of 18-64 population (individuals involved in any stage of entrepenerurial activity excluded) who intend to start a business within three years.  


2. **Nascent Entrepreneurship**: Percentage of 18-64 population who are currently a nascent entrepreneur, i.e., actively involved in setting up a business they will own or co-own; this business has not paid salaries, wages, or any other payments to the owners for more than three months.  


3. **Established Entrepreneur**: Percentage of 18-64 population who are currently owner-manager of an established business, i.e., owning and managing a running business that has paid sallaries, wages, or any other payments to the owners for more than 42 months.  


4. **Way of Teaching**: In my country, teaching in primary and secondary education encourages creativity, self-sufficiency, and personal initiative.  


5. **Perceived Capabilities**: Percentage of 18-64 population who believe to have the required skills and knowledge to start a business  


6. **Fear of Failure**: Percentage of 18-64 population with positive perceived opportunities who indicate that fear of failure would prevent them from setting up a business.  


7. **Perceived Opportunities**: Percentage of 18-64 population who see good opportunities to start a firm in the area where they live


<br>

### Causal Chain  


Our decision to select and investigate these variables was based on the following causal chain

1. An education system that reinforces self-confidence 

2. Higher degree of individual self-esteem  

3. Higher probability an individual becomes an entrepreneur  

4. Higher rate of entrepreneurship at a country-level  


<br>

### Geographic Variation in our Explanatory Variable  

As expected, there is significant variation among OECD countries with respect to each of the variables investigated.  The most important of these variables is our explanatory variable, "WayofTeaching".  This is a measure of how well teaching methods support self-confidence in each country.  The following interactive chart displays variation in self confidence with the log of the mean survey response from each country over 2001-2013 timeframe.


```{r echo =FALSE, cache=FALSE, include=TRUE, results='asis', warning=FALSE, error=FALSE, message=FALSE}
# Import GEM data frame
WayofTeaching <- repmis::source_data("https://raw.githubusercontent.com/SamDund/Assign2Education/master/GEMData/WayofTeaching", header = TRUE, cache = FALSE, na.strings = "NA")

# Drop unnecessary column 1
WayofTeaching$X <- NULL

# Change data from long to wide format
WT <- reshape(WayofTeaching, idvar = c("iso2c", "Country"), timevar = "Year", direction = "wide")

# Delete variable name in Year columns
names(WT) <- gsub("WayofTeaching.", "", names(WT))

# Duplicate df for future use
WT2 <- WT

# Generate a new column with mean of all other columns
WT$mean <- rowMeans(subset(WT, select = c("2001", "2002", "2003", "2004", "2005", "2006", "2007", "2008",
                                          "2009", "2010")), na.rm = TRUE)

# Drop year columns, leaving only mean column
WT$'2001' <- NULL
WT$'2002' <- NULL
WT$'2003' <- NULL
WT$'2004' <- NULL
WT$'2005' <- NULL
WT$'2006' <- NULL
WT$'2007' <- NULL
WT$'2008' <- NULL
WT$'2009' <- NULL
WT$'2010' <- NULL
WT$'2011' <- NULL
WT$'2012' <- NULL
WT$'2013' <- NULL
WT$row.names <- NULL

# Create 
WT[, 3] <- round(log(WT[, 3]), digits = 2)
```

```{r echo = FALSE, cache= TRUE, include= TRUE, results= 'asis'}
library(googleVis)

# Plot
WT_map <- gvisGeoChart(WT, locationvar = 'iso2c',
                      colorvar = 'mean',
                      options = list(
                        colors = "['#ece7f2', '#2b8cbe']"
))
 


print(WT_map, tag = 'chart')

```


<br>


### Statistical Analysis  

The variables indicated above were used to obtain inferential statistics:

Variable | Indicator 
-------------|---------------
Y Dependent Variable | Rate of Entrepreneurship (Intention, Nascent, Established)
X1 Explanatory Variable | Way of Teaching
X2 Control Variable | Perceived Capabilities
X3 Control Variable | Fear of Failure / Perceived Opportunities
X4 Control Variable | Perceived Opportunities  


Based on a review of academic literature and expectations from other data analysis, we expected to see a statistically significant positive relationship between higher self-confidence reinforcement in teaching and our dependent variables selected as indicators of the entrepreneurship rate.  Instead, we found that the Way of Teaching is not significant, and when controlling for country-specific effects, has a negative relationship with our explanatory variables.  Overall, however, we can demonstrate the results of our least square regression equation in the four charts below (omitting the country-specific effects).  We chose to simulate different values in "Percent Perceived Capabilities" and "Way of Teaching" because they are both proxies for self-confidence.

The charts labled "Unimputed" were created using only data collected from GEM. This simulation is not possible with missing data, so observations with missing data were omitted.  To try to address this, we used the R program Amelia to generate an imputed data frame.  This program uses statistical inference to generate this data (more information on Amelia can be found on the program's [CRAN page](http://cran.r-project.org/web/packages/Amelia/index.html)).  Simulations titled "Imputed" were calculated using this imputed data frame.



```{r echo = FALSE, cache= FALSE, include= FALSE}

# Library Zelig (can be buggy if loaded too early)
library(Zelig)

# Library Amelia for imputed data
library(Amelia)


############ Running a regression with full df (including omitted variables)
RG1 <- lm(PercentOwner ~ WayofTeaching + PercentPerceived + PercentFear*PercentOpportunities + PercentOpportunities, data = CD)

RG2 <- lm(PercentOwner ~ WayofTeaching + PercentPerceived + PercentFear*PercentOpportunities + PercentOpportunities + Country, data = CD)

############ Running a regression omitting omitted variables

# Generate a df omitting omitted variables
CD_omitted <- na.omit(CD)

# Run a least squares regression with Zelig
Z1 <- zelig(PercentOwner ~ WayofTeaching + PercentPerceived + PercentFear*PercentOpportunities + PercentOpportunities, data = CD_omitted, model = "ls")

# Set range of PercentPerceived values in simulation
x.out1 <- setx(Z1, PercentPerceived = 9:67)

# Run simulation (default 1000 trials)
simz1 <- sim(Z1, x = x.out1)


############ Runnig a Zelig regression with imputed data and omitting remaining omitted variables

# Import csv of df with imputed figures (created in Index_sources/Amelia_source)
CI <- repmis::source_data("https://raw.githubusercontent.com/SamDund/Assign2Education/gh-pages/Cimputed5.csv", header = TRUE, sep = ",", na.strings = NA)

# Omit variables that could not be imputed by Adelia (b/c of lack of data)
CI_omitted <- na.omit(CI)

# Regression equation with imputed values
Z2 <- zelig(PercentOwner ~ WayofTeaching + PercentPerceived + PercentFear*PercentOpportunities + PercentOpportunities, data = CI_omitted, model = "ls")


############ Set range of values for Z1 and Z2

# Set range of PercentPerceived values in simulation
x.out2 <- setx(Z2, PercentPerceived = 9:67)

# Run simulation (default 1000 trials)
simz2 <- sim(Z2, x = x.out2)

# Set range of WayofTeaching values in simulation
x.out3 <- setx(Z1, WayofTeaching = 1.353:3.278)

# Run simulation (default 1000 trials)
simz3 <- sim(Z1, x = x.out3)

# Set range of WayofTeaching values in simulation
x.out4 <- setx(Z2, WayofTeaching = 1.128:3.312)

# Run simulation (default 1000 trials)
simz4 <- sim(Z2, x = x.out4)

```



```{r echo = FALSE, cache= FALSE, include= TRUE, results= 'asis'}
library("Zelig")

# Set layout
par(mfrow = c(2, 2))

# Plot simz1 (unimputed)
plot(simz1, xlab = 'Percent Perceived Opportunities', ylab = 'Percent Entrepreneurship Owner', main = "Unimputed")

# Plot simz2 (imputed)
plot(simz2, xlab = 'Percent Perceived Opportunities', ylab = 'Percent Entrepreneurship Owner', main = "Imputed")

# Plot simz3 (unimputed)
plot(simz3, xlab = 'Way of Teaching', ylab = 'Percent Entrepreneurship Owner', main = "Unimputed")

# Plot simz4 (imputed)
plot(simz4, xlab = 'Way of Teaching', ylab = 'Percent Entrepreneurship Owner', main = "Imputed")

```

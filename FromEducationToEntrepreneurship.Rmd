---
title: "Country-Level Impact of Education on Entrepreneurship"
author: "Sam Dundon and Thierry Racaud"
date: "29 novembre 2014"
output: html_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

* * * 
```{r echo=FALSE, cache=TRUE, include=FALSE}

# Set working directory
setwd('~/Assign2Education/Proposal')

# Install necessary packages

# Install rempis from Christpher Gandrud's website
devtools::install_github('christophergandrud/repmis')
library(repmis)

# Load citation package
pkgs <- c('repmis')
repmis::LoadandCite(pkgs, file= 'RpackageCitations.bib')

```


*Introduction to Collaborative Social Science Data Analysis*


### Policy Relevance


The process of allocating public funds for education is an opportunity to make calculated long-term investments in a nation's populace. The rationale for decisions made during this process, however, is often difficult to understand. That is, while many claims have been made in entrepreneurship literature regarding the importance of cultural and educational factors -- not just structural and economic factors -- in determining individual and societal tendencies to start a business, these factors are often not included in the decision-making process. Actually, only a few empirical studies have been carried out on this topic and most of them focused on which attitudes were favourable to starting a business, while almost none explored what determined these dispositions.  




#### Research Question  


To what extent do the behavioral characteristics of education systems - individualistic, group-oriented, self-esteem reinforcing - affect the rate of entrepreneurship in OECD countries?  
    



### Literature Review  


What determines entrepreneurship at a country-level has been long searched already but although economic, demographic or geographic factors have been looked at extensively, much less has been done regarding cultural or educational factors. Still, “the relative stability of differences in entrepreneurship across countries suggests that factors other than economic ones are at play” [@Freytag2007] ?????? 2010 VERSION MAIN BIB ?????. Even if “in recent years research has increasingly devoted itself to the subject” [@OECD2009], a lot still needs to be done, as the few studies that explored the relationship between attitudes and foundation activities barely searched what determined these attitudes.

Over a hundred years has passed since Max Weber tried to explain how religious-ethical motivations affect entrepreneurship [@weberprotestant], and religion may be less effective in justifying why some are more likely to start businesses than others. Still, that was a founding stone and it is now widely admitted that “cultural features influence attitudes towards start-ups and that these attitudes, in turn, have an impact on start-up activities” [@OECD2009].

Despite various claims of the existence of a cultural effect, few empirical studies have actually been carried out. It took a few decades more before Davidsson, along with Delmar at first (1992), then alone (1995), then with Wiklund [@davidsson1997values], at his turn, laid a stepping stone by investigating the relationship between structural factors, mainly economic, and cultural factors. As they compared two Swedish regions similar in terms of structure and observed different outcomes, they concluded there may be a small cultural effect in attitudes toward start-up activities.

Rather than trying to trace cultural patterns at large, we intend to focus on one key cultural institution, that is the education system. Indeed, like many in the education literature tend to assert, we believe that school personnel have an affect on student self-confidence [@Scott1996]. Now in entrepreneurship literature, "self-confidence was found to depend almost exclusively on the individual features of the respective person and his or her integration into social networks" [@OECD2009]. Yet, we intend to understand to what extent these individual characteristics are partly shaped through education systems and staff attitudes.

King and Sobel [@Kerry2008], among others, have already tried to show how school choice can increase the rate of youth entrepreneurship, but their perspective was slightly different. They  asserted that a more business-like environment in K-12 education was the key, which was favoured by voucher programmes. We believe there is a more widely spread systematic effect of educational features. The cross-cultural perspective on teaching and learning proposed by Watkins [@Watkins2010] shall help us compare countries. Cheng and Wong’s study about school effectiveness in East Asia [@Cheng2006] will also help.

Further, since self-confidence is considered to rely partly on one’s integration within social networks [@OECD2009], we will refer to cross-cultural studies about individualism and collectivism such as those of Green, Deschamps and Páez [@green2005variation], Pinillos and Reyes ???????? MAIN BIB ??????, Freeman [@freeman1997demographic], Raeff, Greenfield and Quiroz [-@raeff2000conceptualizing]. We will also cite more school-focused research like Yamauchi [@yamauchi1998individualism], Davies and Aurini [@davies2003homeschooling] for these have looked at individualism and collectivism in the classroom and in pedagogy respectively.  

Besides potential educational effects on self-confidence and social capital, we will need to control for all classic entrepreneurship determinants. Therefore, we will quote Grilo and Thurik’s research [@Grilo2005b] about what determines entrepreneurship engagement levels throughout the European Union and the US, Wennekers, Ulhaner and Thurik’s about variation across countries [@Wennekers2002], Freytag and Thurik about determinants in a cross-country setting ????? 2010 VERSION MAINBIB ?????.

Eventually, to put all these into perspective, along with Gartner [@Gartner1990] we will have a closer look at entrepreneurship’s underlying meanings in research and, with Acs, Desai and Klapper [@Acs2008], we will ask ourselves what “entrepreneurship” data really shows.


    
#### Estimation Strategy

##### Causal Chain  

Education system / Teaching reinforcing self-esteem ---> higher degree of individual self-esteem ---> higher probability an individual will become an entrepreneur ---> higher rate of entrepreneurship at a country-level.
<br>

##### Dependent Variables: Explaining the Country-level Rate of Entrepreneurship    


We have examined three dimensions of entrepreneurship to prepare for this stage of the project, established entrepreneurship in the country, nascent entrepreneurship (less than three months), and entrepreneurial intention. We will study each of these successively as we may well observe different effects.  

To measure these three dimensions of entrepreneurship, we have used three [Global Entrepreneurship Monitor (GEM)](http://www.gemconsortium.org) indicators:

- Established Business Ownership Rate (Percentage) 
- Nascent Entrepreneurship Rate (Percentage)
- Entrepreneurial intention Rate (Percentage)  


##### Key Explanatory Variable: Degree of Self-esteem Reinforcement within the Education System    


As Inglehart has shown how personal values are shaped before the age of 20, we will try to show how compulsory education (from 6 to 16 years of age) shapes individuals, especially in terms of self-esteem. To do so, we decided to incorporate GEM indicators that relate to self-esteem and confidence. First, we included GEM survey data on the average "perceived capabilities" of an individual (18-64) in a given country to start a business. Second, we included additional GEM data on how the "fear of failure" could deter an average individual (18-64) in a country to become an entrepreneur. Both of these data sets indicate the average percentage for each characteristic at the country-level.  


##### Control Variables: Controlling for Classic Determinants of Entrepreneurship  


To control for the general state of the economy, we included annual GDP Growth from the World Bank [World Development Indicators](http://data.worldbank.org/data-catalog/world-development-indicators) as a control variable in our regression equations.  In addition, we included a GEM indicator called "Perceived Opportunities." For each country, it is the average percentage of individuals who believe there are opportunities to start a business in their area. Since we look at average individual self-esteem in every OECD country, we believe it is appropriate to look at the opportunities perceived by the average 18-64-year-old individual in these countries.

In the future, we may revise this to include lagged GDP growth in recognition of the time taken for governments and individuals to react to the state of the economy, and are planning to include control variables from GEM. Specifically, we intend to control for the classic determinants of entrepreneurship -- economic and structural determinants. To do so, we will add the following nine key entrepreneurship conditions as defined in the GEM [National Experts Survey (NES)](http://www.gemconsortium.org/Data-Collection).   

1. Finance  
2. Government policies  
3. Government programs  
4. Entrepreneurial Education and Training  
5. Research and Development Transfer (R & D)  
6. Commercial and professional infrastructure  
7. Internal Market openness  
8. Physical infrastructure and services  
9. Cultural and social norms  


##### Regressions


The following equations were used to determine the relationship between our dependent and explanatory variables:  


1. $PercentIntention = PercentPerceived(Perceived Capabilities) + Way of Teaching + PercentOpportunities(Perceived Opportunities)$ 

2. $PercentNascent = PercentPerceived + PercentFear*PercentOpportunities + AnnualGDPGrowth$

3. $PercentOwner = PercentPerceived + PercentFear*PercentOpportunities + AnnualGDPGrowth$  

The variables *Percent Fear* and *Percent Opportunities* were included as an interaction term $PercentFear*PercentOpportunities$ because of the design of the survey. PercentFear is: "the Percentage of 18-64 population with positive perceived opportunities who indicate that fear of failure would prevent them from setting up a business."  

<br>
  
  
  
#### Data Collection and Cleaning

To collect the data necessary to run these regression equations, we downloaded *.csv* data from GEM and used the WDI API to obtain the necessary annual GDP growth of OECD Countries.   


**Necessary R Packages**  


The following packages were needed to complete the data collection portion of this assignment:

- repmis  
- tidyr  
- reshape  
- plyr  
- WDI  


**GEM Data**  


GEM data was embedded in an interactive database and was difficult to extract automatically without writing a program. To simplify this process, we downloaded the necessary *.csv* files and saved them in our GitHub repository (to reduce complexity, we deleted the first three unnecessary rows before saving).  We then linked to the RAW version of the files and added the code required to load them from *R*.  The repmis package is required to load these documents from the repository.  


Cleaning the GEM data required deleting unnecessary characters in the year columns, changing the years from columns to rows (changing the data from wide to long), and changing the column names to describe which data was being analyzed.  In the process of doing this we created new data sets for each of these survey questions, which were called C*dataset* (clean followed by the data set name). This was done for each of the six GEM data sets before merging these sets two at a time to create the data set *FinalGEM*.  


For all 33 OECD countries we should have 13 observations, one per year from 2001 to 2013, for each variable. However, there are a few missing values, especially regarding the perceived opportunities for some countries, namely Estonia, Luxembourg and Slovak Republic.


**World Bank Data**  


As mentioned above, one of our control variables, annual GDP growth, was obtained using the WDI API from the World Bank.  Using this API, we accessed GDP data from all the OECD countries directly from *R*. To clean this data, we used *plyr* to change the variable names then recoded the U.S. and South Korea country names to maintain consistency with the GEM data set and dropped an unnecessary column that was not included with the GEM data.

Finally, we merged the annual GDP growth data with the *FinalGEM* data set to create *CompleteDataset*.  This is the data set used to run the regressions and generate the charts and figures outlined in this document.  To reduce complexity in the environment we also included a command to remove unnecessary objects in the environment.

<br>
```{r echo =FALSE, cache=TRUE, include=FALSE, results='asis', warning=FALSE}

#### Import data from GEM Survey ####

# Import GEM fear of failure data
FearFail <- repmis::source_data("https://raw.githubusercontent.com/SamDund/Assign2Education/master/GEMData/GEM_FearFail.csv", header = TRUE, cache = FALSE) 

# Import GEM estblished entrepreneurship - current owner data
CurrentOwner <- repmis::source_data("https://raw.githubusercontent.com/SamDund/Assign2Education/master/GEMData/GEM_CurrentOwner.csv", header = TRUE, cache = FALSE) 

# Import GEM entrepreneurial intention data
EntreIntention <- repmis::source_data("https://raw.githubusercontent.com/SamDund/Assign2Education/master/GEMData/GEM_EntreIntention.csv", header = TRUE, cache = FALSE) 

# Import GEM nascent entrepreneur data
NascentEntre <- repmis::source_data("https://raw.githubusercontent.com/SamDund/Assign2Education/master/GEMData/GEM_NascentEntre.csv", header = TRUE, cache = FALSE) 

# Import GEM perceived capabilities data
PerceivedCapabilities <- repmis::source_data("https://raw.githubusercontent.com/SamDund/Assign2Education/master/GEMData/GEM_PerceivedCapabilities.csv", header = TRUE, cache = FALSE) 

# Import GEM perceived opportunities data as a proxy for potential control variables
PerceivedOpportunities <- repmis::source_data("https://raw.githubusercontent.com/SamDund/Assign2Education/master/GEMData/PerceivedOpportunities.csv", header = TRUE, cache = FALSE)

# Import 2010GEM supportive teaching data as a proxy for how favourable to self-confidence a given education system is
SupportiveTeaching <- repmis::source_data("https://raw.githubusercontent.com/SamDund/Assign2Education/master/GEMData/GEMAvgIndicators.csv", header = TRUE, cache = FALSE)

# Import GEM 2009 supportive teaching data
setwd('~/Assign2Education/GEMData')

GEM2001 <- read.spss('2001GEMNES.sav', to.data.frame = TRUE)
GEM2002 <- read.spss('2002GEMNES.sav', to.data.frame = TRUE)
GEM2003 <- read.spss('2003GEMNES.sav', to.data.frame = TRUE)
GEM2004 <- read.spss('2004GEMNES.sav', to.data.frame = TRUE)
GEM2005 <- read.spss('2005GEMNES.sav', to.data.frame = TRUE)
GEM2006 <- read.spss('2006GEMNES.sav', to.data.frame = TRUE)
GEM2007 <- read.spss('2007GEMNES.sav', to.data.frame = TRUE)
GEM2008 <- read.spss('2008GEMNES.sav', to.data.frame = TRUE)
GEM2009 <- read.spss('2009GEMNESMDS.sav', to.data.frame = TRUE)
GEM2010 <- read.spss('2010GEMNES.sav', to.data.frame = TRUE)



#### Clean data using tidy ####

### Clean FearFail ###
# Percentage of 18-64 population with positive perceived opportunities who indicate that fear of failure would prevent them from setting up a business.

# Remove X's in FearFail year columns
names(FearFail) <- gsub("X", "", names(FearFail))


# Change years from columns to rows and create CFearFail
CFearFail <- melt(data = FearFail,
                  id.vars = c("Country"),
                  measure.vars = c("2001", "2002", "2003", "2004", "2005", "2006",
                                   "2007", "2008", "2009", "2010", "2011", "2012",
                                   "2013"))

# Rename columns
CFearFail <- plyr::rename(x = CFearFail, 
                                      replace = c("variable" = "Year",
                                                  "value" = "PercentFear"))

### Clean CurrentOwner ###
# Percentage of 18-64 population who are currently owner-manager of an established business, i.e., owning and managing a running business that has paid sallaries, wages, or any other payments to the owners for more than 42 months

# Remove X's in CurrentOwner year columns
names(CurrentOwner) <- gsub("X", "", names(CurrentOwner))


# Change years from columns to rows and create CCurrentOwner
CCurrentOwner <- melt(data = CurrentOwner,
                  id.vars = c("Country"),
                  measure.vars = c("2001", "2002", "2003", "2004", "2005", "2006",
                                   "2007", "2008", "2009", "2010", "2011", "2012",
                                   "2013"))

# Rename columns
CCurrentOwner <- plyr::rename(x = CCurrentOwner, 
                                      replace = c("variable" = "Year",
                                                  "value" = "PercentOwner"))

### Clean EntreIntention ###
# Percentage of 18-64 population (individuals involved in any stage of entrepenerurial activity excluded) who intend to start a business within three years.

# Remove X's in EntreIntention year columns
names(EntreIntention) <- gsub("X", "", names(EntreIntention))


# Change years from columns to rows and create CEntreIntention (No 2001 data available)
CEntreIntention <- melt(data = EntreIntention,
                  id.vars = c("Country"),
                  measure.vars = c("2002", "2003", "2004", "2005", "2006",
                                   "2007", "2008", "2009", "2010", "2011", "2012",
                                   "2013"))

# Rename columns
CEntreIntention <- plyr::rename(x = CEntreIntention, 
                                      replace = c("variable" = "Year",
                                                  "value" = "PercentIntention"))

### Clean NascentEntre ###
# Percentage of 18-64 population who are currently a nascent entrepreneur, i.e., actively involved in setting up a business they will own or co-own; this business has not paid salaries, wages, or any other payments to the owners for more than three months.

# Remove X's in NascentEntre year columns
names(NascentEntre) <- gsub("X", "", names(NascentEntre))


# Change years from columns to rows and create CNascentEntre
CNascentEntre <- melt(data = NascentEntre,
                  id.vars = c("Country"),
                  measure.vars = c("2001", "2002", "2003", "2004", "2005", "2006",
                                   "2007", "2008", "2009", "2010", "2011", "2012",
                                   "2013"))

# Rename columns
CNascentEntre <- plyr::rename(x = CNascentEntre, 
                                      replace = c("variable" = "Year",
                                                  "value" = "PercentNascent"))

### Clean PerceivedCapabilities ###
# Percentage of 18-64 population who believe to have the required skills and knowledge to start a business

# Remove X's in PerceivedCapabilities year columns
names(PerceivedCapabilities) <- gsub("X", "", names(PerceivedCapabilities))

# Change years from columns to rows and create CPreceivedCapabilities
CPerceivedCapabilities<- melt(data = PerceivedCapabilities,
                  id.vars = c("Country"),
                  measure.vars = c("2001", "2002", "2003", "2004", "2005", "2006",
                                   "2007", "2008", "2009", "2010", "2011", "2012",
                                   "2013"))

# Rename columns
CPerceivedCapabilities <- plyr::rename(x = CPerceivedCapabilities, 
                                      replace = c("variable" = "Year",
                                                  "value" = "PercentPerceived"))

### Clean PerceivedOpportunities ###
# Percentage of 18-64 population who see good opportunities to start a firm in the area where they live

# Remove X's in PerceivedOpportunities year columns
names(PerceivedOpportunities) <- gsub("X", "", names(PerceivedOpportunities))

# Change years from columns to rows and create CPreceivedOpportunities
CPerceivedOpportunities<- melt(data = PerceivedOpportunities,
                  id.vars = c("Country"),
                  measure.vars = c("2001", "2002", "2003", "2004", "2005", "2006",
                                   "2007", "2008", "2009", "2010", "2011", "2012",
                                   "2013"))

# Rename columns
CPerceivedOpportunities <- plyr::rename(x = CPerceivedOpportunities, 
                                      replace = c("variable" = "Year",
                                                  "value" = "PercentOpportunities"))


### Clean GEM NES Datasets
# Draw out Country and D01 only
Clean01 <- GEM2001[,c("country", "ki01d01")]
Clean02 <- GEM2002[,c("country", "ki02d01")]
Clean03 <- GEM2003[,c("country", "ki03d01")]
Clean04 <- GEM2004[,c("ki04ctry", "ki04d01")]
Clean05 <- GEM2005[,c("KI05ctry", "KI05D01")]
Clean06 <- GEM2006[,c("KI06CTRY", "KI06D01_mean")]
Clean07 <- GEM2007[,c("ki07ctry", "ki07d01_")]
Clean08 <- GEM2008[,c("NES08COUNTRY", "NES08_D01_MEAN")]
Clean09 <- GEM2009[,c("NES09COUNTRY", "NES09_D01_MEAN")]
Clean10 <- GEM2010[,c("NES10CRNAME", "NES10_D01_MEAN")]

remove(GEM2001, GEM2002, GEM2003, GEM2004, GEM2005, GEM2006, GEM2007, GEM2008, GEM2009, GEM2010)

# Edit column names for each dataframe

Clean01 <- plyr::rename(x = Clean01, 
                                      replace = c("ki01d01" = "Year01",
                                                  "country" = "Country"))

Clean02 <- plyr::rename(x = Clean02, 
                                      replace = c("ki02d01" = "Year02",
                                                  "country" = "Country"))

Clean03 <- plyr::rename(x = Clean03, 
                                      replace = c("ki03d01" = "Year03",
                                                  "country" = "Country"))

Clean04 <- plyr::rename(x = Clean04, 
                                      replace = c("ki04d01" = "Year04",
                                                  "ki04ctry" = "Country"))

Clean05 <- plyr::rename(x = Clean05, 
                                      replace = c("KI05D01" = "Year05",
                                                  "KI05ctry" = "Country"))

Clean06 <- plyr::rename(x = Clean06, 
                                      replace = c("KI06D01_mean" = "Year06",
                                                  "KI06CTRY" = "Country"))
Clean07 <- plyr::rename(x = Clean07, 
                                      replace = c("ki07d01_" = "Year07",
                                                  "ki07ctry" = "Country"))

Clean08 <- plyr::rename(x = Clean08, 
                                      replace = c("NES08_D01_MEAN" = "Year08",
                                                  "NES08COUNTRY" = "Country"))

Clean09 <- plyr::rename(x = Clean09, 
                                      replace = c("NES09_D01_MEAN" = "Year09",
                                                  "NES09COUNTRY" = "Country"))

Clean10 <- plyr::rename(x = Clean10, 
                                      replace = c("NES10_D01_MEAN" = "Year10",
                                                  "NES10CRNAME" = "Country"))



#### Merge the data ####
MergedGEM <- merge(CCurrentOwner, CEntreIntention,
                   union("Country", "Year"),
                   all = TRUE)

MergedGem2 <- merge(CFearFail, CNascentEntre,
                   union("Country", "Year"),
                   all = TRUE) 

MergedGem3 <- merge(CPerceivedCapabilities, MergedGEM,
                   union("Country", "Year"),
                   all = TRUE) 

MergedGem4 <- merge(MergedGem2, MergedGem3,
                   union("Country", "Year"),
                   all = TRUE) 

FinalGEM <- merge(MergedGem4, CPerceivedOpportunities,
                   union("Country", "Year"),
                   all = TRUE)


# Convert percent columns from character to numeric
FinalGEM[,"PercentPerceived"] <- as.numeric(FinalGEM[,"PercentPerceived"])
FinalGEM[,"PercentFear"] <- as.numeric(FinalGEM[,"PercentFear"])
FinalGEM[,"PercentNascent"] <- as.numeric(FinalGEM[,"PercentNascent"])
FinalGEM[,"PercentOwner"] <- as.numeric(FinalGEM[,"PercentOwner"])
FinalGEM[,"PercentIntention"] <- as.numeric(FinalGEM[,"PercentIntention"])
FinalGEM[,"PercentOpportunities"] <- as.numeric(FinalGEM[,"PercentOpportunities"])



# Remove unncessary data from environment
remove(CCurrentOwner, CEntreIntention, CFearFail, CNascentEntre, CPerceivedCapabilities, CPerceivedOpportunities, CurrentOwner, EntreIntention, FearFail, MergedGEM, MergedGem2, MergedGem3, MergedGem4, PerceivedCapabilities, PerceivedOpportunities, NascentEntre)



CleanMerge <- cbind(names = c(rownames(Clean01), rownames(Clean02), rownames(Clean03),
                              rownames(Clean04), rownames(Clean05), rownames(Clean06),
                              rownames(Clean07), rownames(Clean08), rownames(Clean09),
                              rownames(Clean10)),
                    rbind.fill(list(Clean01, Clean02, Clean03, Clean04, Clean05, Clean06,
                                    Clean07, Clean08, Clean09, Clean10)))

# Recode countries
CleanMerge$Country[CleanMerge$Country == "AUSTRALIA"] <- "Australia"
CleanMerge$Country[CleanMerge$Country == "AUSTRIA"] <- "Austria"
CleanMerge$Country[CleanMerge$Country == "BELGIUM"] <- "Belgium"
CleanMerge$Country[CleanMerge$Country == "CANADA"] <- "Canada"
CleanMerge$Country[CleanMerge$Country == "CHILE"] <- "Chile"
CleanMerge$Country[CleanMerge$Country == "CZECH REPUBLIC"] <- "Czech Republic"
CleanMerge$Country[CleanMerge$Country == "DENMARK"] <- "Denmark"
CleanMerge$Country[CleanMerge$Country == "ESTONIA"] <- "Estonia"
CleanMerge$Country[CleanMerge$Country == "FINLAND"] <- "Finland"
CleanMerge$Country[CleanMerge$Country == "FRANCE"] <- "France"
CleanMerge$Country[CleanMerge$Country == "GERMANY"] <- "Germany"
CleanMerge$Country[CleanMerge$Country == "GREECE"] <- "Greece"
CleanMerge$Country[CleanMerge$Country == "HUNGARY"] <- "Hungary"
CleanMerge$Country[CleanMerge$Country == "ICELAND"] <- "Iceland"
CleanMerge$Country[CleanMerge$Country == "IRELAND"] <- "Ireland"
CleanMerge$Country[CleanMerge$Country == "ISRAEL"] <- "Israel"
CleanMerge$Country[CleanMerge$Country == "ITALY"] <- "Italy"
CleanMerge$Country[CleanMerge$Country == "JAPAN"] <- "Japan"
CleanMerge$Country[CleanMerge$Country == "KOREA"] <- "South Korea"
CleanMerge$Country[CleanMerge$Country == "LUXEMBURG"] <- "Luxemburg"
CleanMerge$Country[CleanMerge$Country == "MEXICO"] <- "Mexico"
CleanMerge$Country[CleanMerge$Country == "NETHERLANDS"] <- "Netherlands"
CleanMerge$Country[CleanMerge$Country == "NEW ZEALAND"] <- "New Zealand"
CleanMerge$Country[CleanMerge$Country == "NORWAY"] <- "Norway"
CleanMerge$Country[CleanMerge$Country == "POLAND"] <- "Poland"
CleanMerge$Country[CleanMerge$Country == "PORTUGAL"] <- "Portugal"
CleanMerge$Country[CleanMerge$Country == "SLOVAK REPUBLIC"] <- "Slovak Republic"
CleanMerge$Country[CleanMerge$Country == "SLOVENIA"] <- "SLOVENIA"
CleanMerge$Country[CleanMerge$Country == "SPAIN"] <- "Spain"
CleanMerge$Country[CleanMerge$Country == "SWEDEN"] <- "Sweden"
CleanMerge$Country[CleanMerge$Country == "SWITZERLAND"] <- "Switzerland"
CleanMerge$Country[CleanMerge$Country == "TURKEY"] <- "Turkey"
CleanMerge$Country[CleanMerge$Country == "UNITED KINGDOM"] <- "United Kingdom"
CleanMerge$Country[CleanMerge$Country == "UK"] <- "United Kingdom"
CleanMerge$Country[CleanMerge$Country == "USA"] <- "United States"
CleanMerge$Country[CleanMerge$Country == "UNITED STATES"] <- "United States"
CleanMerge$Country[CleanMerge$Country == "Korea"] <- "South Korea"
CleanMerge$Country[CleanMerge$Country == "US"] <- "United States"


# Set columns to numeric
CleanMerge[,"Year01"] <- as.numeric(CleanMerge[,"Year01"])
CleanMerge[,"Year02"] <- as.numeric(CleanMerge[,"Year02"])
CleanMerge[,"Year03"] <- as.numeric(CleanMerge[,"Year03"])
CleanMerge[,"Year04"] <- as.numeric(CleanMerge[,"Year04"])
CleanMerge[,"Year05"] <- as.numeric(CleanMerge[,"Year05"])
CleanMerge[,"Year04"] <- as.numeric(CleanMerge[,"Year06"])
CleanMerge[,"Year04"] <- as.numeric(CleanMerge[,"Year07"])
CleanMerge[,"Year08"] <- as.numeric(CleanMerge[,"Year08"])
CleanMerge[,"Year09"] <- as.numeric(CleanMerge[,"Year09"])
CleanMerge[,"Year10"] <- as.numeric(CleanMerge[,"Year10"])


ddply(pp, .(names), function(x) colSums(x[,-1], na.rm = TRUE))

ddply(CleanMerge, .(names), function(x) colSums(x[,-1], na.rm = TRUE))

arrange()

# Change merged data from wide to long
LongGEM<- melt(data = Merged9,
                  id.vars = c("Country"),
                  measure.vars = c("2001", "2002", "2003", "2004", "2005", "2006",
                                   "2007", "2008", "2009", "2010"))

# Rename columns
names(LongGEM) <- gsub("variable", "Year", names(LongGEM))
names(LongGEM) <- gsub("value", "Support", names(LongGEM))


# Create a vector with OECD countries
myvars <- c('Australia', 'Austria', 'Belgium', 'Canada', 'Chile', 'Czech Republic', 'Denmark', 'Estonia', 'Finland', 'France', 'Germany', 'Greece', 'Hungary', 'Iceland', 'Ireland', 'Israel', 'Italy', 'Japan', 'Korea', 'Luxemburg', 'Mexico', 'Netherlands', 'New Zealand', 'Norway', 'Poland', 'Portugal', 'Slovak Republic', 'Slovenia', 'Spain', 'Sweden', 'Switzerland', 'Turkey', 'United Kingdom', 'United States')

# Subset LongGEM with the countries we need
subset_data <- subset(LongGEM, Country %in% myvars)

# Delete unnecessary column
subset_data$row.names <- NULL

# Arrange subset_data by country and year
GrandData <- arrange(subset_data, Country, Year) 

GrandData1 <- GrandData[order("Country",)]

########### STUCK #############

FinalData <- merge(FinalGEM, GrandData,
                   union("Country", "Year"))


```

#### Data Analysis  


To examine the relationship between these variables, we used least square estimation, the results of which can be found in the following table. The package *stargazer* was required to generate this table.  As evidenced by the equation results, the individual variables selected are statistically significant, but the model only explains a relatively small degree of the variation in the dependent variable.  For example, the adjusted $R^2$ of regression equation one is 0.29, the adjusted $R^2$ of regression equation two is 0.38, and the adjusted $R^2$ is 0.13.  
<br>




```{r echo =FALSE, cache=TRUE, include=FALSE, results='asis', warning=FALSE}


# Run linear regression R1
R1 <- lm(PercentIntention ~ PercentPerceived + PercentFear*PercentOpportunities + Country, data = CompleteDataset)

# Obtain summary statistics of R1
summary(R1)

# Run linear regression R2
R2 <- lm(PercentNascent ~ PercentPerceived + PercentFear*PercentOpportunities + Country, data = CompleteDataset)

# Obtain summary statistics of R2
summary(R2)


# Run linear regression R3
R3 <- lm(PercentOwner ~ PercentPerceived + PercentFear*PercentOpportunities + AnnualGDPGrowth, data = CompleteDataset)
 
# Obtain summary statistics of R3
summary(R3)
```                           
  

```{r echo = FALSE, cache=TRUE, include=TRUE, results='asis', warning=FALSE} 

# Library Stargazer for regression output tables
library(stargazer)

# Create regression output table
labels <- c('National Level Avg Perceived Capabilities', 'National Level Avg Fear of Failure',
            'Annual GDP Growth', 'National Level Avg Perceived Good Opportunities', 'National Level Avg Fear of Failure x National Level Avg Perceived Good Opportunities','(Intercept)')

dlables <- c('National Level Average Percent Entrepreneurial Intention', 'National Level Nascent Entrepreneural Activity', 'National Level Average Percent Owning a Business')

stargazer::stargazer(R1, R2, R3, covariate.labels = labels, dep.var.labels = dlables,
                     title = 'Linear Regression Estimates', digits = 2, type = 'html')
```
<br>  
National-level average of people perceiving opportunities but acknowledging fear of failure will prevent them from creating a business (FF)  
  
**Simulation Package and Cleaning**


In addition to the output table, a simulation is helpful to visually illustrate the relationship the probability of obtaining a given value in the dependent variables conditional on change in the independent variable.  We used the *Zelig* package to run a least square regression and generate a simulation of equation 1.  Prior to running this regression, however, we ran the na.omit command to remove omitted variables from the equation.

To examine the probabilities of achieving given outcomes, we generated three simulations for the first regression equation.  To demonstrate this method, we have included one simulation below.  



**Process**  


First, we estimated a least square equation with variation in the variable *PercentPerceived* of 20-100 percent. The ranges for variance in the independent variables was chosen by identifying the best range for capturing the largest degree of variance for the model.  The first simulation is below.  The y axis shows variation in *PercentIntention* conditional on change in *PercentPerceived* and the x axis shows variation in *PercentPerceived*. The results may be interpreted as showing that people who believe they have the knowledge required to start a business may or may not do so (with a high degree of variation), while people who do not believe they have this knowledge are consistently unlikely to start a business (there is little variation).

```{r echo = FALSE, cache=TRUE, include=FALSE, results='asis', warning=FALSE}

# Library Zelig (can be buggy if loaded to early)
library(Zelig)

# Omit omitted data from simulation
CompleteData_omit <- na.omit(CompleteDataset)

# Run a least squares regression with Zelig
Z1 <- zelig(PercentIntention ~ PercentPerceived + PercentFear*PercentOpportunities + AnnualGDPGrowth, data = CompleteData_omit, model = "ls")
```

```{r echo = FALSE, cache=TRUE, include=TRUE, results='asis', warning=FALSE }

# Find appropriate range for PercentPerceived
summary(CompleteData_omit$PercentPerceived)

# Set range of PercentPerceived values in simulation
x.out2 <- setx(Z1, PercentPerceived = 9:67)

# Run simulation (default 1000 trials)
simz2 <- sim(Z1, x = x.out2)

# Adjust margins
par(mar=c(2,2,2,2))

# Plot simulation
plot(simz2, xlab= 'PercentPerceived')

```

<br>



#### Outlook  


Going forward, we are considering adding one of the six questions used by GEM to measure the importance of entrepreneurial education at the country level in its NES Survey.  Item D01 states "in my country, teaching in primary and secondary education encourages creativity, self-sufficiency, and personal initiative." This could be a proxy to get a sense of how supportive of self esteem a given education system is.

We may also want to quantify how individualistic or group-oriented an average student is by the end of compulsory education, as the literature holds social inclusion as an explanatory factor for self-esteem. We will use OECD PISA data on "the sense of belonging" for this.  

Next steps will also include looking more thoroughly into control variables and determining the most appropriate way to present our results. To do so we may need to extract data from various national NES reports and put together a table, as it does not seem to exist as such.

```{r echo = FALSE, cache=TRUE, include=TRUE, results='asis', warning=FALSE}

library(stargazer)
stargazer(CompleteDataset, type = 'html')

```

Estonia
Luxemburg
Slovak Republic 

